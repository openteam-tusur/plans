<h1>Рабочая программа дисциплины  &quot;<%= @discipline.title %>&quot; <%= @work_programm.year %> года</h1>

<%= render :partial => 'head' %>

<%= link_to "Скачать PDF рабочей программы", resource_path(:format => :pdf) %>

<h3 class='center'>1. Цели и задачи дисциплины, ее место в учебном процессе</h3>

<div class='work_programm_wrapper with_text_styles'>
  <h4 class='center'>1.1 Цели</h4>
  <div class="work_programm_purpose">
    <%= @work_programm.purpose_html %>
  </div>
  <% if @work_programm.purpose? %>
    <%= link_to "Редактировать цели", '#', :class => 'add_text purpose' %>
  <% else %>
    <%= link_to "Добавить цели", '#', :class => 'add_text purpose' %>
  <% end %>
</div>

<div class='work_programm_wrapper with_text_styles missions_wrapper'>
  <h4 class='center'>1.2 Задачи</h4>
  <div class="work_programm_task">
    <ol class='mission_list'>
      <% @work_programm.missions.each do |mission| %>
        <%= render mission %>
      <% end %>
    </ol>
    <%= link_to "Добавить задачу", new_year_speciality_subspeciality_discipline_work_programm_mission_path(@year, @speciality, @subspeciality, @discipline, @work_programm), :remote => true, :class => 'new' %>
  </div>
  <div class="work_programm_requirements">
    <h5>По окончанию изучения дисциплины «<%= @discipline %>» студент обязан:</h5>
    <ul class='requirement_list'>
      <% @work_programm.requirements.each do |requirement| %>
        <%= render requirement %>
      <% end %>
    </ul>
  </div>
</div>

<h4 class="center">1.3 Место дисциплины в учебном процессе</h4>
<div class="discipline_wrapper">
  <h5>1.3.1 Предшествующие дисциплины</h5>
  <div class="disciplines" style='display: none;'>
    <%= resource.available_previous_disciplines.map(&:title) %>
  </div>
  <ul>
    <% @work_programm.previous_disciplines.each do |discipline| %>
      <li>
        <%= discipline.title %>
        <%= link_to "Удалить", year_speciality_subspeciality_discipline_work_programm_dependent_discipline_path(@year, @speciality, @subspeciality, @discipline, @work_programm, discipline), :method => :delete, :confirm => t('are_you_sure?'), :class => 'delete_link' %>
      </li>
    <% end %>
  </ul>
  <%= link_to "Добавить дисциплину", new_year_speciality_subspeciality_discipline_work_programm_dependent_discipline_path(@year, @speciality, @subspeciality, @discipline, @work_programm, :params => {:dependent_discipline => { :dependency_type => 'previous' }}), :class => 'add_discipline', :remote => true %>
</div>

<div class="discipline_wrapper">
  <h5>1.3.2 Совместно идущие дисциплины</h5>
  <div class="disciplines" style='display: none;'>
    <%= resource.available_current_disciplines.map(&:title) %>
  </div>
  <ul>
    <% @work_programm.current_disciplines.each do|discipline| %>
      <li>
        <%= discipline.title %>
        <%= link_to "Удалить", year_speciality_subspeciality_discipline_work_programm_dependent_discipline_path(@year, @speciality, @subspeciality, @discipline, @work_programm, discipline), :method => :delete, :confirm => t('are_you_sure?'), :class => 'delete_link' %>
      </li>
    <% end %>
  </ul>
  <%= link_to "Добавить дисциплину", new_year_speciality_subspeciality_discipline_work_programm_dependent_discipline_path(@year, @speciality, @subspeciality, @discipline, @work_programm, :params => {:dependent_discipline => { :dependency_type => 'current' }}), :class => 'add_discipline', :remote => true %>
</div>

<div class="discipline_wrapper">
  <h5>1.3.3 Последующие дисциплины</h5>
  <div class="disciplines" style='display: none;'>
    <%= resource.available_subsequent_disciplines.map(&:title) %>
  </div>
  <ul>
    <% @work_programm.subsequent_disciplines.each do|discipline| %>
      <li>
        <%= discipline.title %>
        <%= link_to "Удалить", year_speciality_subspeciality_discipline_work_programm_dependent_discipline_path(@year, @speciality, @subspeciality, @discipline, @work_programm, discipline), :method => :delete, :confirm => t('are_you_sure?'), :class => 'delete_link' %>
      </li>
    <% end %>
  </ul>
  <%= link_to "Добавить дисциплину", new_year_speciality_subspeciality_discipline_work_programm_dependent_discipline_path(@year, @speciality, @subspeciality, @discipline, @work_programm, :params => {:dependent_discipline => { :dependency_type => 'subsequent' }}), :class => 'add_discipline', :remote => true %>
</div>

<h4 class='center'>2. Содержание дисциплины</h4>

<% index = 1 %>
<% Exercise.enum_values(:kind).each do |kind| %>
  <h5 class='center'>2.<%= index %> <%= t("activerecord.attributes.exercise.#{kind.pluralize}") %></h5>
  <% index += 1 %>
  <% grouped_loadings = resource.discipline.loadings.where(:loading_kind => kind).group_by(&:semester) %>
  <%= content_tag :p, 'Занятия не предусмотрены учебным планом' if grouped_loadings.empty?  %>
  <% grouped_loadings.each do |semester, loadings| %>
    <%= render :file => 'exercises/index', :locals => { :semester => semester, :kind => kind, :loadings => loadings } %>
  <% end %>
<% end %>
