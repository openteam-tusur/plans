<h1>Рабочая программа дисциплины  &quot;<%= @discipline.title %>&quot; <%= @work_programm.year %> года</h1>

<%= render :partial => 'head' %>

<%= link_to "Скачать PDF рабочей программы", resource_path(:format => :pdf) %>

<h3 class='center'>1. Цели и задачи дисциплины, ее место в учебном процессе</h3>

<div class='work_programm_wrapper with_text_styles'>
  <h4 class='center'>1.1 Цели</h4>
  <div class="work_programm_purpose">
    <%= simple_format @work_programm.purpose %>
  </div>
  <% if @work_programm.purpose? %>
    <%= link_to "Редактировать цели", '#', :class => 'add_text purpose' %>
  <% else %>
    <%= link_to "Добавить цели", '#', :class => 'add_text purpose' %>
  <% end %>
</div>

<div class='work_programm_wrapper with_text_styles missions_wrapper'>
  <h4 class='center'>1.2 Задачи</h4>
  <div class="work_programm_task">
    <ol class='mission_list'>
      <% @work_programm.missions.each do |mission| %>
        <%= render mission %>
      <% end %>
    </ol>
    <%= link_to "Добавить задачу", new_year_speciality_subspeciality_discipline_work_programm_mission_path(@year, @speciality, @subspeciality, @discipline, @work_programm), :remote => true, :class => 'new' %>
  </div>
  <div class="work_programm_requirements">
    <h5>По окончанию изучения дисциплины «<%= @discipline %>» студент обязан:</h5>
    <ul class='requirement_list'>
      <% @work_programm.requirements.each do |requirement| %>
        <%= render requirement %>
      <% end %>
    </ul>
  </div>
</div>

<h4 class="center">1.3 Место дисциплины в учебном процессе</h4>
<% %w[previous_disciplines current_disciplines subsequent_disciplines].each_with_index do |name, index| %>
  <div class="discipline_wrapper">
    <h5>1.3.<%= index + 1 %> <%= WorkProgramm.human_attribute_name(name) %></h5>
    <ul>
      <% @work_programm.send(name).each do |discipline| %>
        <li>
          <%= discipline.title %>
        </li>
      <% end %>
    </ul>
  </div>
<% end %>
<%= link_to "Изменить список связанных дисциплин", edit_resource_path, :class => 'add_discipline' %>

<h4 class='center'>2. Содержание дисциплины</h4>

<% index = 1 %>
<% Exercise.enum_values(:kind).each do |kind| %>
  <h5 class='center'>2.<%= index %> <%= Exercise.human_attribute_name kind.pluralize %></h5>
  <% index += 1 %>
  <% grouped_loadings = resource.discipline.loadings.where(:loading_kind => kind).group_by(&:semester) %>
  <%= content_tag :p, 'Занятия не предусмотрены учебным планом' if grouped_loadings.empty?  %>
  <% grouped_loadings.each do |semester, loadings| %>
    <%= render :file => 'exercises/index', :locals => { :semester => semester, :kind => kind, :loadings => loadings } %>
  <% end %>
<% end %>

<h5 class='center'>2.5 <%= Exercise.human_attribute_name :srs %></h5>
<% grouped_loadings = resource.discipline.loadings.where(:loading_kind => :srs).group_by(&:semester) %>
<%= content_tag :p, 'Занятия не предусмотрены учебным планом' if grouped_loadings.empty? %>

<h4 class="center">3. Учебно-методические материалы по дисциплине</h4>
<h5 class='center'>3.1 Основная литература</h5>
<%= render :partial => 'self_educations/self_education' %>

<%= link_to 'Изменить', [(resource.self_education ? :edit : :new), association_chain, resource, :self_education].flatten %>

<%= render :file => 'publications/index', :locals => { :kind => 'basic' } %>

<h5 class='center'>3.2 Дополнительная литература</h5>

<%= render :file => 'publications/index', :locals => { :kind => 'additional' } %>

<h5 class='center'>3.3 Перечень учебно-методических пособий (УМП) </h5>

<% resource.ump_publication_kinds.each_with_index do |kind, index| %>
  <h6>3.3.<%= index + 1 %> <%= t("activerecord.attributes.publication.publication_kind_enum.ump_#{kind}") %></h6>
  <%= render :file => 'publications/index', :locals => { :kind => "ump_#{kind}" } %>
<% end %>
